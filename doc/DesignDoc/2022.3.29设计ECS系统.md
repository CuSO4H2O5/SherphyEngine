# ECS系统设计

ECS的实现并非一个简单的过程，但作为雪比引擎的开端，我们将尽力实现这套系统。

## 过去的经验

在二月时，我们参考图形API实现了一套耦合性很弱的模拟环境系统。核心思想是将模拟空间看作一个数据空间，以类外函数而非类内函数对类进行操作，实现数据与操作分离。缺点是很明显的，函数归属性很弱（当然这也是优点），由于非类内调用造成了一部分性能损失。而雪比引擎的ECS系统也将以该思路为核心继续发展。

## 最简单的组件-Entity

组合与继承，一个类通常有这两种关系。

继承通常有两个缺点：

1、菱形继承问题

2、多继承问题

菱形继承问题导致同一数据类可能被多次包含，而多继承问题则导致类层数过高，效率低下。

而我们理想的Entity各部件之间应当减少所属关系，类似于坦克应当由炮塔与车身组成，没有从属关系，且只在控制开火/旋转与物理链接上有通信与相关。因此我们写下如下代码：

```C++
class Component{ }
class Entity{
    unordered_map<Component> components;
}
```

通过建立一个哈希表来快速获取组件信息。

